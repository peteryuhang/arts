## swap 空间在 Linux 下的快速构建方法

### 什么是 swap 空间？（**What**）

  中文翻译过来叫做 **交换空间**，说得具体点是 **内存交换空间**。就是在磁盘中开辟一部分的空间来辅助内存的使用

### 为什么要有 swap 空间，它解决了什么问题？（**Why**）

  - 计算机中有个常识是 **CPU 只会从内存而不是其他 I/O 读取所需要的数据**。因此大部分时候，内存都会从硬盘中提前加载
  并缓存大量的 CPU 近期可能会用到的数据进来。有些时候，服务器的请求激增，有些请求的数据并不在内存当中，并且内存容量
  已满，这时内存需要在整个磁盘中通过特定的服务或方式找到这些数据，并扔掉内存中已存在的一些数据。这个过程耗时耗力，并且
  被扔掉的数据也是有一定几率被 CPU 所用。因此，在磁盘中开辟一个地方，专门存放这些暂时被内存丢弃的数据，可以看做是一个
  二级内存，这样可以在一定程度上辅助内存，提升整个系统的运作效率
  - swap 解决的是内存资源不足时所带来的系统运作效率下降的问题。当然，如果你可以升级你的内存，或者你的内存对你的服务来说
  完全够用，则不需要 swap。swap 只是在有限资源下，为节省开支，退而求其次的做法。话说回来，配一点 swap 空间也是好的，毕竟
  谁也不能保证内存在任何时候都 100% 够用，另外磁盘空间相对内存来说再廉价不过了，以防万一也是好的

### 怎么构建 swap 空间？（**How**）

  - 一般来说 swap 的大小最好设置在内存的 1.5 ～ 2 倍

  - 通常来讲，有两种方式构建 swap 空间
    - 在磁盘中设置一个 swap 分区
    - **创建一个虚拟内存文件**
  
  - 这里我们使用第二种，因为不需要重新对整个硬盘做格式化等耗时耗力的操作，比较简单实用

  ```bash
  # 通过 dd 指令创建一个 1G 大小的文件
  >$ dd if=/dev/zero of=/tmp/swap bs=1M count=1024
  # 将创建的文件格式化为 swap 的文件格式
  >$ mkswap /tmp/swap
  # 使用 swapon 来将创建的文件启动
  >$ swapon /tmp/swap
  # 可以通过 free 命令查看当前的 swap 空间以及内存的状态
  >$ free
  # 查看系统中所有 swap 空间的信息
  >$ swapon -s
  # 如若不需要 swap 空间了，可用 swapoff 指令将其卸载
  >$ swapoff /tmp/swap
  ```

  